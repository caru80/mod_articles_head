/**
 * @package        HEAD. Article Module
 * @version        1.8.9
 * 
 * @author         Carsten Ruppert <webmaster@headmarketing.de>
 * @link           https://www.headmarketing.de
 * @copyright      Copyright Â© 2018 HEAD. MARKETING GmbH All Rights Reserved
 * @license        http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL
 */
(function(c){c.ModIntroAJAX=function(a,b){this.module=c(b);this.module.data("modintroajax",this);this._init(a)};c.ModIntroAJAX.Defaults={evNamespace:".modintro.ajax",html:{loading:'<div class="mod-intro-loading"><div class="sk-cube-grid"><div class="sk-cube sk-cube1"></div><div class="sk-cube sk-cube2"></div><div class="sk-cube sk-cube3"></div><div class="sk-cube sk-cube4"></div><div class="sk-cube sk-cube5"></div><div class="sk-cube sk-cube6"></div><div class="sk-cube sk-cube7"></div><div class="sk-cube sk-cube8"></div><div class="sk-cube sk-cube9"></div></div></div>'},
request:{option:"com_ajax",module:"articles_head",method:"getList",format:"raw"},ajaxConfig:null,scroll:{enabled:!0,duration:1E3,offsetQuery:"",offsetManual:0}};c.ModIntroAJAX.prototype={_init:function(a){this.opt=c.extend(!0,{},c.ModIntroAJAX.Defaults,a);this.setup();this.module.on("afterLoad",function(){this.setup()}.bind(this))},setup:function(){for(var a=this.module.find("[data-modintroajax]"),b=0,c=a.length;b<c;b++)a.eq(b).off(this.opt.evNamespace).one("click"+this.opt.evNamespace,function(a){this.sendRequest(a.currentTarget)}.bind(this));
this.module.find(".set-filters").off(this.opt.evNamespace).on("click"+this.opt.evNamespace,function(){this.applyFilterGroups()}.bind(this));this.module.find(".reset-filters").off(this.opt.evNamespace).on("click"+this.opt.evNamespace,function(){this.resetFilterGroups()}.bind(this))},postEffects:function(a){var b=c(a);a=b.find(".item-column");var d=this.opt.ajaxConfig.aniname;-1<d.indexOf(",")&&(d=d.split(","),d=d.map(Function.prototype.call,String.prototype.trim));a.css({visibility:"hidden"});this.opt.ajaxConfig.replace?
(c(this.opt.ajaxConfig.target).html(b),c(this.opt.ajaxConfig.target).css({height:""})):c(this.opt.ajaxConfig.target).append(b);this.opt.scroll.enabled&&this.scrollToNewItems();b=function(){var a=this.data("modintroanim");this.one("webkitAnimatioEnd msAnimationEnd animationend",function(){var a=c(this).data("modintroanim");c(this).removeClass(a["class"]+" "+a.name)});a&&this.addClass(a["class"]+" "+a.name).css({visibility:""})};for(var e=0,g=a.length;e<g;e++){var h=a.eq(e),f=d;"object"===typeof f&&
(f=f[Math.floor(Math.random()*f.length)]);h.data("modintroanim",{"class":this.opt.ajaxConfig.aniclass,name:f});window.setTimeout(b.bind(a.eq(e)),100*e)}},setFilterGroupValues:function(a){var b=c(a).data("filtergroup"),d=[];c('[name="'+b.field+'"]',a).each(function(){switch(this.nodeName.toLowerCase()){case "input":switch(b.type){case "html5range":case "range":d[d.length]=this.value;break;default:this.checked&&""!=this.value&&(d[d.length]=this.value)}break;case "select":for(var a=0,c=this.options.length;a<
c;a++)this.options[a].selected&&""!=this.options[a].value&&(d[d.length]=this.options[a].value)}});"custom"===b.param?(this.opt.ajaxConfig[b.param]||(this.opt.ajaxConfig[b.param]={}),this.opt.ajaxConfig[b.param][b.id]=d):this.opt.ajaxConfig[b.param]=d},resetFilterGroups:function(){this.module.triggerHandler("resetFilters");this.opt.ajaxConfig.catid=[];this.opt.ajaxConfig.tag=[];this.opt.ajaxConfig.custom={};this.module.find("[data-filtergroup]").each(function(){var a=c(this).data("filtergroup");c(this).find('[name="'+
a.field+'"]').each(function(){switch(this.nodeName.toLowerCase()){case "input":switch(a.type){case "range":var b=document.getElementById(""!=a.id?"slider-"+a.param+"-"+a.id+"[]":"slider-"+a.param+"[]");b&&b.noUiSlider.reset();break;default:this.checked&&(this.checked=!1)}break;case "select":b=0;for(var c=this.options.length;b<c;b++)this.options[b].selected&&(this.options[b].selected=!1)}})});this.sendRequest()},applyFilterGroups:function(){this.opt.ajaxConfig.s=0;this.opt.ajaxConfig.replace=!0;this.opt.ajaxConfig.filter=
!0;var a=this;this.module.find("[data-filtergroup]").each(function(){a.setFilterGroupValues(this)});this.sendRequest()},scrollToNewItems:function(){var a=c(this.opt.ajaxConfig.target).find(".async");a=a.eq(a.length-1).offset().top;if(""!=this.opt.scroll.offsetQuery){var b=c(this.opt.scroll.offsetQuery);b.length&&(a-=b.outerHeight())}a-=this.opt.scroll.offsetManual;a=void 0!==Math.trunc?Math.trunc(a):a;a!==c(document).scrollTop()&&c("html, body").stop().animate({scrollTop:a},{duration:this.opt.scroll.duration,
easing:"swing"})},sendRequest:function(a){a&&(a=c(a),this.opt.ajaxConfig=c.extend({},this.opt.ajaxConfig,a.data("modintroajax")));this.opt.request.modid=this.opt.ajaxConfig.id;this.opt.request.start=this.opt.ajaxConfig.s;this.opt.ajaxConfig.catid&&(this.opt.request.catid=this.opt.ajaxConfig.catid);this.opt.ajaxConfig.tag&&(this.opt.request.tag=this.opt.ajaxConfig.tag);this.opt.ajaxConfig.custom&&(this.opt.request.custom=this.opt.ajaxConfig.custom);if(this.opt.ajaxConfig.replace){var b=c(this.opt.ajaxConfig.target);
b.css({height:b.outerHeight()})}else a&&(b=a.parent());!this.opt.ajaxConfig.filter&&a&&a.remove();var d=c(this.opt.html.loading);b.html(d);c.ajax({url:this.opt.ajaxConfig.url,type:"POST",data:this.opt.request,success:function(a){d.remove();this.opt.ajaxConfig.animate?this.postEffects(a):(this.opt.ajaxConfig.replace?(c(this.opt.ajaxConfig.target).css({height:""}),c(this.opt.ajaxConfig.target).html(a)):c(this.opt.ajaxConfig.target).append(a),this.opt.scroll.enabled&&this.scrollToNewItems());this.module.triggerHandler("afterLoad")}.bind(this),
error:function(a){console.log(a)}})}};c.fn.modintroajax=function(a){var b=c(this).data("modintroajax");b||(b=new c.ModIntroAJAX(a,this));return b}})(jQuery);
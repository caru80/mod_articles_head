/**
 * @package        HEAD. Article Module
 * @version        1.8.1
 * 
 * @author         Carsten Ruppert <webmaster@headmarketing.de>
 * @link           https://www.headmarketing.de
 * @copyright      Copyright Â© 2018 HEAD. MARKETING GmbH All Rights Reserved
 * @license        http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL
 */
(function(b){b.ModIntroAJAX=function(a,c){this.module=b(c);this.module.data("modintroajax",this);this._init(a)};b.ModIntroAJAX.Defaults={evNamespace:".modintro.ajax",html:{loading:'<div class="mod-intro-loading"><div class="sk-cube-grid"><div class="sk-cube sk-cube1"></div><div class="sk-cube sk-cube2"></div><div class="sk-cube sk-cube3"></div><div class="sk-cube sk-cube4"></div><div class="sk-cube sk-cube5"></div><div class="sk-cube sk-cube6"></div><div class="sk-cube sk-cube7"></div><div class="sk-cube sk-cube8"></div><div class="sk-cube sk-cube9"></div></div></div>'},
request:{option:"com_ajax",module:"articles_head",method:"getList",format:"raw"},ajaxConfig:null};b.ModIntroAJAX.prototype={_init:function(a){this.opt=b.extend(!0,{},b.ModIntroAJAX.Defaults,a);this.setup();this.module.on("afterLoad",function(){this.setup()}.bind(this))},setup:function(){for(var a=this.module.find("[data-modintroajax]"),c=0,b=a.length;c<b;c++)a.eq(c).off(this.opt.evNamespace).one("click"+this.opt.evNamespace,function(a){this.sendRequest(a.currentTarget)}.bind(this));this.module.find(".set-filters").off(this.opt.evNamespace).on("click"+
this.opt.evNamespace,function(){this.applyFitlerGroups()}.bind(this));this.module.find(".reset-filters").off(this.opt.evNamespace).on("click"+this.opt.evNamespace,function(){this.resetFilterGroups()}.bind(this))},postEffects:function(a){var c=b(a);a=c.find(".item");a.css({visibility:"hidden",opacity:"0"});this.opt.ajaxConfig.replace?b(this.opt.ajaxConfig.target).html(c):b(this.opt.ajaxConfig.target).append(c);c=function(){var a=this.data("modintroanim");this.one("webkitAnimatioEnd msAnimationEnd animationend",
function(){var a=b(this).data("modintroanim");b(this).removeClass(a["class"]+" "+a.name)});a&&this.addClass(a["class"]+" "+a.name).css({visibility:"",opacity:"1"})};for(var d,e=0,f=a.length;e<f;e++)d=a.eq(e),d.data("modintroanim",{"class":this.opt.ajaxConfig.aniclass,name:this.opt.ajaxConfig.aniname}),window.setTimeout(c.bind(a.eq(e)),100*e)},setFilterGroupValues:function(a){var c=b(a).data("filtergroup"),d=[];b('[name="'+c.field+'"]',a).each(function(){switch(this.nodeName.toLowerCase()){case "input":this.checked&&
""!=this.value&&(d[d.length]=this.value);break;case "select":for(var a=0,b=this.options.length;a<b;a++)this.options[a].selected&&""!=this.options[a].value&&(d[d.length]=this.options[a].value)}});this.opt.ajaxConfig[c.name]=d},resetFilterGroups:function(){this.module.triggerHandler("resetFilters");this.opt.ajaxConfig.catid=[];this.opt.ajaxConfig.tag=[];this.module.find("[data-filtergroup]").each(function(){var a=b(this).data("filtergroup");b(this).find('[name="'+a.field+'"]').each(function(){switch(this.nodeName.toLowerCase()){case "input":this.checked&&
(this.checked=!1);break;case "select":for(var a=0,b=this.options.length;a<b;a++)this.options[a].selected&&(this.options[a].selected=!1)}})});this.sendRequest()},applyFitlerGroups:function(){this.opt.ajaxConfig.s=0;this.opt.ajaxConfig.replace=!0;this.opt.ajaxConfig.filter=!0;var a=this;this.module.find("[data-filtergroup]").each(function(){a.setFilterGroupValues(this)});this.sendRequest()},sendRequest:function(a){a&&(a=b(a),this.opt.ajaxConfig=b.extend({},this.opt.ajaxConfig,a.data("modintroajax")));
this.opt.request.modid=this.opt.ajaxConfig.id;this.opt.request.start=this.opt.ajaxConfig.s;this.opt.ajaxConfig.catid&&(this.opt.request.catid=this.opt.ajaxConfig.catid);this.opt.ajaxConfig.tag&&(this.opt.request.tag=this.opt.ajaxConfig.tag);var c;this.opt.ajaxConfig.replace?c=b(this.opt.ajaxConfig.target):a&&(c=a.parent());!this.opt.ajaxConfig.filter&&a&&a.remove();var d=b(this.opt.html.loading);c.html(d);b.ajax({url:this.opt.ajaxConfig.url,type:"POST",data:this.opt.request,success:function(a){d.remove();
this.opt.ajaxConfig.animate?this.postEffects(a):this.opt.ajaxConfig.replace?b(this.opt.ajaxConfig.target).html(a):b(this.opt.ajaxConfig.target).append(a);this.module.triggerHandler("afterLoad")}.bind(this),error:function(a){console.log(a)}})}};b.fn.modintroajax=function(a){var c=b(this).data("modintroajax");c||(c=new b.ModIntroAJAX(a,this));return c}})(jQuery);
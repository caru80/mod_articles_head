/**
 * @package        HEAD. Article Module
 * @version        1.7.3
 * 
 * @author         Carsten Ruppert <webmaster@headmarketing.de>
 * @link           https://www.headmarketing.de
 * @copyright      Copyright Â© 2018 HEAD. MARKETING GmbH All Rights Reserved
 * @license        http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL
 */
(function(c){c.ModIntroVideo=function(b,a){this.module=c(a);this.module.data("modintrovideo",this);this._init(b)};c.ModIntroVideo.Defaults={evNamespace:".modintro.video",allowTouch:!1,itemSelector:"article"};c.ModIntroVideo.prototype={_init:function(b){this.opt=c.extend(!0,{},c.ModIntroVideo.Defaults,b);this.setup();this.module.on("afterLoad",function(){this.setup()}.bind(this))},setup:function(){for(var b=this.module.find(this.opt.itemSelector),a,c=0,e=b.length;c<e;c++)a=b.eq(c),a.children(".item-introvideo").length&&
(a.off(this.opt.evNamespace),a.on("mouseleave"+this.opt.evNamespace,function(a){this.hideIntroVideo(a.currentTarget)}.bind(this)),a.triggerHandler("mouseleave"));b.find(".item-introvideo.with-full-video").length&&this.bindLightboxes()},bindLightboxes:function(){if(c.featherlight){var b=this.module.find(".item-introvideo.with-full-video");if(b.length)for(var a,d=0,e=b.length;d<e;d++)a=b.eq(d),a.off(this.opt.evNamespace),a.on("click"+this.opt.evNamespace,function(a){a.preventDefault();a='<div class="video-player">   <video class="featherlight-video" autoplay controls volume="70" type="video/mpeg">       <source src="'+
c(this).data("fullvideo")+'" type="video/mp4" />   </video></div>';c.featherlight(a,{openSpeed:750})})}else $app&&$app.extensions.list.featherlight&&$app.extensions.list.featherlight.autoload?(console&&console.log("mod_articles_head: Warte auf Featherlight.js von $app."),c($app).one("featherlightReady",function(){this.bindLightboxes()}.bind(this))):console&&console.log("mod_articles_head: Featherlight.js ist nicht installiert.")},hideIntroVideo:function(b){b=c(b);var a=b.find(".item-introvideo");
if(a.length&&(a.removeClass("in"),a=a.find("video"),a.length)){a=a.get(0);c(a).attr("autoplay")||(a.pause(),a.currentTime&&(a.currentTime=0));if(!this.opt.allowTouch)b.one("touchstart"+this.opt.evNamespace,function(a){c(this).off("mouseover"+this.opt.evNamespace)});b.one("mouseover"+this.opt.evNamespace,function(a){this.showIntroVideo(a.currentTarget)}.bind(this))}},showIntroVideo:function(b){b=c(b);b=b.find(".item-introvideo");if(b.length){var a=b.find("video");a&&(b.addClass("in"),a.get(0).play())}}};
c.fn.modintrovideo=function(b){var a=c(this).data("modintrovideo");a||(a=new c.ModIntroVideo(b,this));return a}})(jQuery);